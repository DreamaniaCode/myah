'use client';

import { useState } from 'react';
import styles from './WhatsAppButton.module.css';

export default function WhatsAppButton() {
    const [showPopup, setShowPopup] = useState(false);

    // TODO: Replace with actual WhatsApp number
    const whatsappNumber = '+212600000000'; // Replace with your actual number
    const message = 'السلام عليكم، أحتاج إلى مساعدة بخصوص منتجاتكم';

    const handleWhatsAppClick = () => {
        const whatsappUrl = `https://wa.me/${whatsappNumber.replace(/[^0-9]/g, '')}?text=${encodeURIComponent(message)}`;
        window.open(whatsappUrl, '_blank');
        setShowPopup(false);
    };

    return (
        <>
            {/* WhatsApp Floating Button */}
            <button
                className={styles.whatsappButton}
                onClick={() => setShowPopup(true)}
                aria-label="تواصل معنا عبر واتساب"
            >
                <svg
                    viewBox="0 0 32 32"
                    fill="currentColor"
                    width="28"
                    height="28"
                >
                    <path d="M16 0c-8.837 0-16 7.163-16 16 0 2.825 0.737 5.607 2.137 8.048l-2.137 7.952 7.933-2.127c2.42 1.37 5.173 2.127 8.067 2.127 8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 29.467c-2.482 0-4.908-0.646-7.07-1.87l-0.507-0.292-5.305 1.422 1.428-5.318-0.32-0.527c-1.305-2.17-1.993-4.652-1.993-7.215 0-7.72 6.28-14 14-14s14 6.28 14 14-6.28 14-14 14zM21.305 18.694c-0.372-0.186-2.197-1.083-2.537-1.208-0.341-0.124-0.589-0.185-0.837 0.187-0.248 0.372-0.961 1.207-1.179 1.455s-0.434 0.279-0.806 0.093c-0.372-0.186-1.571-0.579-2.991-1.846-1.106-0.987-1.853-2.206-2.071-2.578s-0.023-0.573 0.163-0.758c0.167-0.166 0.372-0.434 0.558-0.651 0.186-0.217 0.248-0.372 0.372-0.62 0.124-0.248 0.062-0.465-0.031-0.651s-0.837-2.015-1.147-2.759c-0.302-0.724-0.609-0.626-0.837-0.638-0.217-0.011-0.465-0.013-0.713-0.013s-0.651 0.093-0.992 0.465c-0.341 0.372-1.301 1.271-1.301 3.099s1.332 3.594 1.518 3.842c0.186 0.248 2.625 4.008 6.359 5.619 0.888 0.383 1.581 0.612 2.122 0.783 0.892 0.283 1.704 0.243 2.347 0.147 0.716-0.107 2.197-0.898 2.507-1.766s0.31-1.611 0.217-1.766c-0.093-0.155-0.341-0.248-0.713-0.434z" />
                </svg>
            </button>

            {/* Popup */}
            {showPopup && (
                <div className={styles.popupOverlay} onClick={() => setShowPopup(false)}>
                    <div className={styles.popup} onClick={(e) => e.stopPropagation()}>
                        <button
                            className={styles.closeButton}
                            onClick={() => setShowPopup(false)}
                            aria-label="إغلاق"
                        >
                            ✕
                        </button>

                        <div className={styles.popupContent}>
                            <div className={styles.icon}>
                                <svg
                                    viewBox="0 0 32 32"
                                    fill="currentColor"
                                    width="48"
                                    height="48"
                                >
                                    <path d="M16 0c-8.837 0-16 7.163-16 16 0 2.825 0.737 5.607 2.137 8.048l-2.137 7.952 7.933-2.127c2.42 1.37 5.173 2.127 8.067 2.127 8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 29.467c-2.482 0-4.908-0.646-7.07-1.87l-0.507-0.292-5.305 1.422 1.428-5.318-0.32-0.527c-1.305-2.17-1.993-4.652-1.993-7.215 0-7.72 6.28-14 14-14s14 6.28 14 14-6.28 14-14 14zM21.305 18.694c-0.372-0.186-2.197-1.083-2.537-1.208-0.341-0.124-0.589-0.185-0.837 0.187-0.248 0.372-0.961 1.207-1.179 1.455s-0.434 0.279-0.806 0.093c-0.372-0.186-1.571-0.579-2.991-1.846-1.106-0.987-1.853-2.206-2.071-2.578s-0.023-0.573 0.163-0.758c0.167-0.166 0.372-0.434 0.558-0.651 0.186-0.217 0.248-0.372 0.372-0.62 0.124-0.248 0.062-0.465-0.031-0.651s-0.837-2.015-1.147-2.759c-0.302-0.724-0.609-0.626-0.837-0.638-0.217-0.011-0.465-0.013-0.713-0.013s-0.651 0.093-0.992 0.465c-0.341 0.372-1.301 1.271-1.301 3.099s1.332 3.594 1.518 3.842c0.186 0.248 2.625 4.008 6.359 5.619 0.888 0.383 1.581 0.612 2.122 0.783 0.892 0.283 1.704 0.243 2.347 0.147 0.716-0.107 2.197-0.898 2.507-1.766s0.31-1.611 0.217-1.766c-0.093-0.155-0.341-0.248-0.713-0.434z" />
                                </svg>
                            </div>

                            <h2>هل تحتاج إلى مساعدة؟</h2>
                            <p>نحن هنا لمساعدتك! تواصل معنا عبر واتساب للحصول على:</p>

                            <ul>
                                <li>استشارة مجانية حول المنتجات</li>
                                <li>معلومات عن الطلبات</li>
                                <li>إجابات على استفساراتك</li>
                            </ul>

                            <button onClick={handleWhatsAppClick} className={styles.whatsappActionButton}>
                                <svg
                                    viewBox="0 0 32 32"
                                    fill="currentColor"
                                    width="20"
                                    height="20"
                                >
                                    <path d="M16 0c-8.837 0-16 7.163-16 16 0 2.825 0.737 5.607 2.137 8.048l-2.137 7.952 7.933-2.127c2.42 1.37 5.173 2.127 8.067 2.127 8.837 0 16-7.163 16-16s-7.163-16-16-16zM16 29.467c-2.482 0-4.908-0.646-7.07-1.87l-0.507-0.292-5.305 1.422 1.428-5.318-0.32-0.527c-1.305-2.17-1.993-4.652-1.993-7.215 0-7.72 6.28-14 14-14s14 6.28 14 14-6.28 14-14 14zM21.305 18.694c-0.372-0.186-2.197-1.083-2.537-1.208-0.341-0.124-0.589-0.185-0.837 0.187-0.248 0.372-0.961 1.207-1.179 1.455s-0.434 0.279-0.806 0.093c-0.372-0.186-1.571-0.579-2.991-1.846-1.106-0.987-1.853-2.206-2.071-2.578s-0.023-0.573 0.163-0.758c0.167-0.166 0.372-0.434 0.558-0.651 0.186-0.217 0.248-0.372 0.372-0.62 0.124-0.248 0.062-0.465-0.031-0.651s-0.837-2.015-1.147-2.759c-0.302-0.724-0.609-0.626-0.837-0.638-0.217-0.011-0.465-0.013-0.713-0.013s-0.651 0.093-0.992 0.465c-0.341 0.372-1.301 1.271-1.301 3.099s1.332 3.594 1.518 3.842c0.186 0.248 2.625 4.008 6.359 5.619 0.888 0.383 1.581 0.612 2.122 0.783 0.892 0.283 1.704 0.243 2.347 0.147 0.716-0.107 2.197-0.898 2.507-1.766s0.31-1.611 0.217-1.766c-0.093-0.155-0.341-0.248-0.713-0.434z" />
                                </svg>
                                تواصل معنا الآن
                            </button>
                        </div>
                    </div>
                </div>
            )}
        </>
    );
}
